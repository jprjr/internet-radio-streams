#!/usr/bin/env bash

playlists_root_dir="."
pls_dir="${playlists_root_dir}/pls/somafm"
m3u_dir="${playlists_root_dir}/m3u/somafm"

mkdir -p "${pls_dir}"
mkdir -p "${m3u_dir}"

AAC=1

if [[ $AAC -gt 0 ]]; then
	URL_APPEND=130
else
	URL_APPEND=""
fi


declare -A stations=(
  ["indiepop"]="Indie Pop Rocks"
  ["folkfwd"]="Folk Forward"
  ["bagel"]="BAGeL Radio"
  ["digitalis"]="Digitalis"
  ["7soul"]="Seven Inch Soul"
  ["groovesalad"]="Groove Salad"
  ["gsclassic"]="Groove Salad Classic"
  ["lush"]="Lush"
  ["spacestation"]="Space Station Soma"
  ["sonicuniverse"]="Sonic Universe"
  ["secretagent"]="Secret Agent"
  ["suburbsofgoa"]="Suburbs of Goa"
  ["defcon"]="DEF CON Radio"
  ["thetrip"]="The Trip"
  ["cliqhop"]="cliqhop idm"
  ["dubstep"]="Dub Step Beyond"
  ["missioncontrol"]="Mission Control"
  ["bootliquor"]="Boot Liquor"
  ["covers"]="Covers"
  ["u80s"]="Underground 80s"
  ["beatblender"]="Beat Blender"
  ["brfm"]="Black Rock FM"
  ["sf1033"]="SF 10-33"
  ["illstreet"]="Illinois Street Lounge"
  ["deepspaceone"]="Deep Space One"
  ["dronezone"]="Drone Zone"
  ["poptron"]="PopTron"
  ["sxfm"]="South by Soma"
  ["seventies"]="Left Coast 70s"
  ["thistle"]="ThistleRadio"
  ["fluid"]="Fluid"
  ["metal"]="Metal Detector"

  # A seasonal channel. For Halloween 2019, was a station named "doomed"
  ["specials"]="Specials"

  # Seasonal holiday stations Updated as of Dec 2019
  ["jollysoul"]="Jolly Ol Soul"
  ["xmasinfrisko"]="Xmas in Frisko"
  ["xmasrocks"]="Christmas Rocks"
  ["christmas"]="Christmas Lounge"
)

for station in "${!stations[@]}"; do
  echo "Downloading ${stations["$station"]}"
  pls_url="http://somafm.com/$station$URL_APPEND.pls"
  m3u_url="http://somafm.com/m3u/$station$URL_APPEND.m3u"

  pls_file="${pls_dir}/${stations["$station"]}.pls"
  m3u_file="${m3u_dir}/${stations["$station"]}.m3u"

  wget -nv -O "${pls_file}" "${pls_url}"
  wget -nv -O "${m3u_file}" "${m3u_url}"
done
